# LVit
# Feature Aligned Linear Attention-Pixel Shuffle Autoencoder for Visual Anomaly Detection

# Datasets used this work:
The UCSD datasets are available publicly at http://www.svcl.ucsd.edu/projects/anomaly/dataset.htm.

The CHUK Avenue dataset is also available at http://www.cse.cuhk.edu.hk/leojia/projects/detectabnormal/dataset.html.

The Shanghai Tech video dataset containing all training and testing samples is available at https://mha.cs.umn.edu/proj_events.shtml#crowd.

# Requirements
pytorch 2.1 or later/
pytorch_msssim\
StepLR
collections
einops
tqdm

# Description
We provide the utlility model file as "LViT.ipynb" and the model file as "model.ipnyb"
Training parameters:
embedding_dimesion = "512"
num_layers = "8"
num_heads = "8"
patch_size = "16"
img_size= "256"
batch_size= "4"
lr= "1e-4"
epochs = "200"
loss weights = [1, 0.85, 0.1]


<img width="951" height="486" alt="image" src="https://github.com/user-attachments/assets/39692c6c-4588-4263-9bd5-72d958f07ccb" />

Figure 1. Architecture of the proposed method.

<img width="948" height="270" alt="image" src="https://github.com/user-attachments/assets/527e29e2-758c-411c-b6b3-84ebbd2494ac" />

Figure 2. Structure of the linear complexity attention transformer layer used in the encoder of the proposed model.

<img width="917" height="872" alt="image" src="https://github.com/user-attachments/assets/5a3d97da-edb1-4d3d-be2a-18de1ae51054" />

Figure 3. Anomaly score curves for (a) UCSD Ped2, (b) Avenue, and (c) Ubnormal datasets, illustrating the model's ability to distinguish between normal and abnormal events. The shaded regions in green and red represent ground-truth normal and abnormal frames, respectively. Anomalies are highlighted with red boxes.

<img width="940" height="486" alt="image" src="https://github.com/user-attachments/assets/78c76aa9-0cdd-40c7-aa61-42674e2c27ec" />

Figure 4. Example visualizations of ground truth frames, output generated by the proposed method, and error maps belonging to normal and abnormal classes across three benchmark datasets. Normal samples are outlined in green while abnormal samples are outlined in red. The red boxes highlight anomalies.

#If you encounter and problem or need any relevant information, feel free to contact santos.prk22@gmail.com




